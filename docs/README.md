### 🎄크리스마스 이벤트 내용 정리

#### 🗓️ 12월 달력 정보 정리

- 1일은 금요일이고 크리스마스 당일(25일)은 월요일이다.
- 주말은 금, 토요일이다.
- 평일은 일 ~ 목요일이다.
- 별이 표시되어 있는 요일은 일요일이며, 25일에도 별이 존재한다.

#### ℹ️ 이벤트 중 할인 정보 정리

- 크리스마스 디데이 할인
    - 이벤트 기간은 **1일부터 25일**이다.(26일 부터는 적용이 되지 않는다.)
    - 1일에 1,000원 할인 시작으로 하루가 지날수록 100원이 더 추가되어 할인된다.(1일에는 1,000원 할인, 2일에는 1,100원 할인, 25일에는 3,400원 할인)
- 평일 할인(일요일 ~ 목요일)
    - 디저트 메뉴를 메뉴 **1개당** 2,023원 할인한다.
- 주말 할인(금요일, 토요일)
    - 메인 메뉴를 메뉴 **1개당** 2,023원 할인한다.
- 특별 할인
    - 이벤트 달력에 별이 있으면 **총 주문 금액에서** 1,000원 할인한다.
    - 별이 있는 날짜는 크리스마스 당일(25일 월요일)과 12월의 모든 일요일에 해당한다.
- 증정 이벤트
    - **할인 전** 총 주문 금액이 12만원 이상일 때, 샴페인 1개를 증정한다.
    - 할인 전 총 주문 금액에는 포함하지 않지만 총 혜택 금액에는 포함시켜야 한다.
    - 샴페인 1개의 금액은 25,000원이다.
- 이벤트 기간
    - 크리스마스 마스 디데이 할인을 제외한 다른 이벤트는 12월 한달 내내 적용된다.

#### ✨ 혜택 금액에 따른 12월 이벤트 배지 부여

- 혜택 금액, 즉 할인된 금액과 샴페인 증정 이벤트로 증정된 샴페인 가격을 활용한다.
- 총 혜택 금액에 따라 각각 다른 이벤트 배지를 부여한다.
    - 5천 원 이상: 별 ⭐️
    - 1만 원 이상: 트리 🎄
    - 2만 원 이상: 산타 🎅🏻

#### ⛔ 고객에게 안내해야 할 이벤트 주의 사항

- 총 주문 금액이 10,000원 이상일 경우에만 이벤트가 적용된다.
- 음료만 주문할 수 없다.
- 메뉴는 최대 한 번에 20개까지 주문이 가능하다.
    - (시저샐러드-1, 티본스테이크-1, 제로콜라-1의 경우에는 3개를 주문한 것이다.)

---

### 🖥️ 프로그램 진행 흐름

1. 프로그램을 시작하고 고객에게 날짜를 입력받는다.

    ``` 
    안녕하세요! 우테코 식당 12월 이벤트 플래너입니다.
    12월 중 식당 예상 방문 날짜는 언제인가요? (숫자만 입력해 주세요!)
    ```

2. 날짜에 대한 유효성을 검증한다.
    - 1 이상 31 이하의 숫자여야 한다.
    - 예외 사항 정리
        - 입력 값이 숫자가 아닌 경우(abc)
        - 범위를 벗어난 수를 입력한 경우(-1, 32, 0)
    - 유효하지 않으면 에러 메시지를 출력하고 날짜를 다시 입력받는다.

3. 주문 메뉴와 개수를 입력받는다.

    ``` 
    주문하실 메뉴를 메뉴와 개수를 알려 주세요. (e.g. 해산물파스타-2,레드와인-1,초코케이크-1)
    ```

4. 주문에 대한 유효성을 검증한다.
    - 예외 사항 정리
        - 메뉴 형식이 잘못 입력된 경우
            - 메뉴와 개수 사이의 구분자가 '-'가 아닌 경우(해산물파스타!2,레드와인!1,초코케이크-1)
            - 각 메뉴 사이의 구분자가 ','가 아닌 경우(해산물파스타-2|레드와인-1|초코케이크-1)
            - 메뉴와 개수 및 구분자 사이에 공백이 존재하는 경우(해산물파스타 -2, 레드와인- 1,초코케이크-1)
        - 메뉴판에 없는 메뉴를 입력한 경우(딸기케이크-2)
        - 메뉴의 개수가 정수가 아닌 경우(시저샐러드-a)
        - 메뉴의 개수가 1보다 작은 경우(시저샐러드-0)
        - 중복 메뉴를 입력한 경우(시저샐러드-1,시저샐러드-1)
        - 메뉴의 개수가 20개가 넘어가는 경우(시저샐러드-10,해산물파스타-10,레드와인-1)
        - 음료만 주문한 경우(레드와인-1)
    - 유효하지 않은 경우에는 에러 메시지를 출력하고 주문을 다시 입력받는다.

5. 날짜와 주문을 이용해 총주문 금액, 증정 메뉴, 혜택 내역, 총혜택 금액, 할인 후 예상 결제 금액 및 이벤트 배지를 결정한다.
    - 1일에 1,000원으로 시작해서 크리스마스가 다가올수록 날마다 100원씩 추가 할인한다.(1일부터 25일 사이)
    - 평일(일~목)에는 디저트 메뉴를 1개당 2,023원씩 할인한다.
    - 주말(금,토)에는 메인 메뉴를 1개당 2,023원씩 할인한다.
    - 일요일과 25일에는 총주문 금액에서 1,000원 할인한다.
    - 할인 전 금액이 12만 원 이상이면 샴페인을 증정한다. 증정 메뉴, 혜택 내역, 총혜택 금액에 포함해야 한다.
    - 총 혜택 금액에 따라 5천 원 이상은 별, 1만 원 이상은 트리, 2만원 이상은 산타 배지를 증정한다.

6. 계산한 이벤트 내역을 고객에게 출력한다.
    - 증정 메뉴, 혜택 내역, 12월 이벤트 배지의 디폴트 값은 없음이다.
    - 총혜택 금액의 디폴트 값은 0원이다.
    ``` 
    12월 3일에 우테코 식당에서 받을 이벤트 혜택 미리 보기!
   
    <주문 메뉴>
    티본스테이크 1개
    바비큐립 1개
    초코케이크 2개
    제로콜라 1개
   
    <할인 전 총주문 금액>
    142,000원
   
    <증정 메뉴>
    샴페인 1개
   
    <혜택 내역>
    크리스마스 디데이 할인: -1,200원
    평일 할인: -4,046원
    특별 할인: -1,000원
    증정 이벤트: -25,000원
   
    <총혜택 금액>
    -31,246원
   
    <할인 후 예상 결제 금액>
    135,754원
   
    <12월 이벤트 배지>
    산타
    ```

---

### 💻 구현 목록 정리

#### 고객으로부터 입력을 받는 부분

- 공통 부분
    - [x] 예외 처리를 진행하고 예외 사항이 존재하지 않으면 값을 저장한다.
    ```
    저장한 Date와 Menu를 이용해 Customer에 날짜와 메뉴를 저장한다.
    ```
    - [x] 예외 사항이 발생한 경우에는 IllegalArgumentException을 던지고 값을 다시 입력 받는다.
        - [x] 예외 메시지에는 [ERROR]가 포함되어 있어야 한다.
    - [x] 입력이 공백인 경우 또는 값이 없는 경우를 확인한다.
        ```
        NullAndEmptyValidator에서 문자열을 입력받을 때 검증한다.
        ```
- 날짜를 입력 받는다.
    ``` 
    ChristmasEventManager 클래스에서 날짜에 대한 입력을 받는다.
    ConvertInputValidator 클래스에서 입력 값을 숫자로 변환한다.
    DateValidator 클래스를 이용해 입력된 날짜의 유효성을 검증한다.(삭제)
        -> 1과 31 사이에 존재하는지만 판단하면 되기 때문에 굳이 분리하지 않아도 될 것이라고 판단
    검증 후에 날짜를 Date 클래스에 저장한다.
    ```
    - [x] 예외 처리 사항([ERROR] 유효하지 않은 날짜입니다. 다시 입력해 주세요.)
        - [x] 수가 아닌 경우
        - [x] 범위를 벗어난 경우(1~31)
- 메뉴를 입력 받는다.
    ``` 
    ChristmasEventManager 클래스에서 메뉴에 대한 입력을 받는다.
    ConvertInputValidator 클래스에서 Map으로 변환한다. 변환 과정에서 입력 형식과 메뉴의 중복 그리고 메뉴의 개수가 정수인지만 검증한다.
    MenuValidator 클래스에서 그밖의 예의 사항을 검증한다.
    검증 후에 메뉴를 Menu 클래스에 저장한다.
    ```
    - [x] 예외 처리 사항([ERROR] 유효하지 않은 주문입니다. 다시 입력해 주세요.)
        - [x] 메뉴 형식이 잘못 입력된 경우
            ```
            [리팩토링 후의 메뉴 형식 예외 처리]
          
            메뉴 형식을 처리하는 과정은 다음과 같다.
            먼저 콤마(,)를 이용해 String을 쪼갠다.
            콤마(,)가 제거된 String에서 다시 하이픈(-)을 이용해 쪼갠 후 쪼개진 문자열의 개수가 각각 2개인지 판단한다.
            
            e.g.) 입력값이 "초코케이크-1,아이스크림-1"일 경우
                  먼저 콤마(,)로 쪼개는 과정을 거친다. -> "초코케이크-1"과 "아이스크림-1"이 된다.
                  다시 하이픈(-)으로 쪼갠다. -> 초코케이크와 1로 쪼개지기 때문에 개수가 2이고, 아이스크림과 1로 쪼개지기 때문에 2가 된다.
                  따라서 적합한 메뉴 입력 형식이라고 볼 수 있다.
          
            e.g.) 입력값이 "초코케이크,1-아이스크림-1"일 경우
                  먼저 콤마(,)로 쪼개는 과정을 거치면 "초코케이크"와 "1-아이스크림-1"이 된다.
                  다시 하이픈(-)으로 쪼개면 초코케이크는 개수가 1, 1-아이스크림-1은 1, 아이스크림, 1로 쪼개져서 개수가 3이 된다.
                  각각의 개수가 2가 아니기 때문에 올바른 입력 형식이 아니라고 볼 수 있다.
            ```
            ```
            [리팩토링 전의 메뉴 형식 예외 처리]
          
            메뉴 형식을 판단하는 과정은 다음과 같다.
            먼저 콤마(,)와 하이픈(-)을 입력값에서 제외해 리스트로 만든다.
            입력값에 존재하는 콤마(,)와 하이픈(-)의 개수를 각각 구한다.
          
            하이픈(-)의 수 * 2 = 리스트에 존재하는 문자열의 수, 하이픈(-)의 수 = 콤마(,)의 수 + 1일 경우에 메뉴 형식이 옳은 경우라고 판단한다.
          
            e.g.) 입력값이 "초코케이크-1,아이스크림-1"일 경우에 콤마(,)와 하이픈(-)을 제외한 리스트의 크기는 4가 된다.
                  콤마(,)의 수는 1개, 하이픈(-)의 수는 2개이다. 하이픈의 수 * 2 = 2 * 2 = 4를 만족하고 콤마(,)의 수 + 1 = 하이픈(-)이므로 옳은 형식이다.
          
            e.g.) 입력값이 "초코케이크!1,아이스크림-1"일 경우에 콤마(,)와 하이픈(-)을 제외한 리스트에 포함된 문자열을 파악해보자.
                  콤마(,)와 하이픈(-)을 분리해서 저장한 리스트는 ["초코케이크!1", "아이스크림", "1"]과 같다. 즉, 리스트의 크기는 3이 된다.
                  콤마(,)의 수는 1개, 하이픈(-)의 수는 1개이다. 하이픈의 수 * 2 != 3이므로 잘못된 형식으로 주문을 입력받은 것으로 판단해 예외처리한다.
          
            e.g.) 입력값이 "--초코케이크1,딸기케이크2"일 경우에 콤마(,)와 하이픈(-)을 제외한 리스트에 포함된 문자열을 파악해보자.
                  콤마(,)와 하이픈(-)을 분리해서 저장한 리스트는 ["초코케이크1", "딸기케이크2"]가 된다. 리스트의 크기는 2이다.
                  콤마(,)의 수는 1개, 하이픈(-)의 수는 2개로 콤마(,)의 수 + 1 = 하이픈의 수(-)는 만족한다. 
                  하지만 하이픈의 수 * 2 != 2이므로 잘못된 형식으로 주문을 입력받은 것으로 판단해 예외처리한다.
          
            위와 같이 판단할 때 "초코케이크,1-딸기케이크-1"와 같은 입력을 받았을 때는 메뉴 형식이 옳다고 판단한다.
            따라서 위와 같은 케이스는 따로 처리를 해야 한다.
            구분자만 모두 모아 리스트로 만들고 번갈아 가면서 존재하는지 확인하면 된다. 구분자가 1개 존재할 경우에는 하이픈(-)이 존재하는지만 확인한다.
            리스트의 크기가 1인 경우에는 하이픈(-)만 존재한다.
            메뉴를 2개 이상 주문할 경우에는 구분자가 3개 이상이기 때문에 따로 예외를 생각할 필요 없이 이전의 구분자와 현재 구분자가 다른지만 확인하면 된다.
          
            e.g.) 입력값이 "초코케이크-1"인 경우에는 구분자 리스트가 ["-"]이 되므로 올바른 입력 형식이다.
          
            e.g.) 입력값이 "초코케이크,1-딸기케이크-2"인 경우에는 구분자 리스트가 [",", "-", "-"]가 된다.
                  하이픈(-)과 콤마(,)가 번갈아 가면서 존재하지 않기 때문에 올바른 입력 형식이 아니라고 판단해 예외처리한다.
          
            e.g.) 입력값이 "초코케이크-1,딸기케이크-2"인 경우에는 구분자 리스트가 ["-", "," ,"-"]가 된다.
                  하이픈(-)과 콤마(,)가 번갈아 가면서 존재하기 때문에 올바른 입력 형식이라고 할 수 있다.
            ```
            - [x] 메뉴와 개수 사이의 구분자가 '-'가 아닌 경우(해산물파스타!2,레드와인!1,초코케이크!1)
            - [x] 각 메뉴 사이의 구분자가 ','가 아닌 경우(해산물파스타-2|레드와인-1|초코케이크-1)
            - [x] 메뉴와 개수 및 구분자 사이에 공백이 존재하는 경우(해산물파스타 -2, 레드와인- 1,초코케이크-1)
        - [x] 메뉴의 개수가 정수가 아닌 경우(시저샐러드-a)
        - [x] 중복 메뉴를 입력한 경우(시저샐러드-1,시저샐러드-1)
        - [x] 메뉴판에 없는 메뉴를 입력한 경우(딸기케이크-2)
        - [x] 메뉴의 개수가 1보다 작은 경우(시저샐러드-0)
        - [x] 메뉴의 개수가 20개가 넘어가는 경우(시저샐러드-10,해산물파스타-10,레드와인-1)
        - [x] 음료만 주문한 경우(레드와인-1)

#### 할인 전 총주문 금액 계산 후 혜택 내역이 존재하는지 확인한다.

``` 
Order 클래스에서 Map을 이용해 할인 전 총주문 금액을 계산하고 금액이 12만 원 이상인지 확인한다.
```

- [x] 입력한 주문을 바탕으로 할인 전 총주문 금액을 계산한다.
- [x] 할인 전 총 주문 금액이 12만 원 이상인지 확인하고 12만 원 이상일 경우에는 샴페인 1개를 증정한다.

#### 이벤트 적용을 위해 날짜가 각 이벤트에 맞는지 판단하고 할인 금액을 계산한다.

``` 
Date 클래스에서 날짜에 대한 처리를 진행한다.

  입력 받은 날짜가 크리스마스 디데이 할인이 적용되는 날짜인지 확인한다.
  평일인지 주말인지 확인한다.
  달력에 별표가 존재하는지 확인한다.(일요일, 25일)
  
  요일을 확인하는 과정은 java.time.LocalDate를 이용해서 계산한다.
  DayOfWeek는 월요일이 1이고 1씩 증가해서 일요일은 7이 된다.
  
  크리스마스 디데이 할인 적용은 날짜가 25 이하의 숫자인지만 확인하면 된다.
  평일은 일요일부터 목요일까지기 때문에 요일의 값이 1에서 4, 7일 경우이다.
  주말은 금요일과 토요일이기 때문에 요일 값이 5와 6이다.
  달력에 별이 존재하는 경우는 일요일과 25일이기 때문에 요일 값이 7, 날짜가 25인 경우이다.
  
Date 클래스에서는 요일만 확인하고 계산은 Order 클래스에서 진행한다.
Order 클래스에서 각 이벤트에 맞게 혜택 금액을 계산하고 혜택의 번호을 key로, 혜택 금액을 value로 설정해 Map에 저장한다.

할인 전 총주문 금액이 만 원을 넘지 않는 경우에 대한 처리는 Customer 클래스에서 관리한다.
```

- [x] 할인 전 총주문 금액이 만 원을 넘지 않는 경우 이벤트가 적용되지 않으므로 계산할 필요가 없다.
- [x] 날짜가 1 ~ 25일 사이일 경우에는 크리스마스 디데이 할인이 적용된다.
    - [x] 날짜가 1 ~ 25일 사이에 존재하는지 판단한다.
    - [x] 1일에 1,000원을 시작으로 날마다 100원씩 할인 금액이 증가해 25일에는 3,400원을 할인한다.
      - [x] 1일으로부터 얼마나 지났는지 확인한다.
- [x] 요일이 평일일 경우에는 평일 할인이 적용된다.
    - [x] 요일이 평일인지 판단한다.
    - [x] 디저트 메뉴 1개당 1,000원 할인을 적용한다.
- [x] 요일이 주말일 경우에는 주말 할인이 적용된다.
    - [x] 요일이 주말인지 판단한다.
    - [x] 메인 메뉴 1개당 1,000원 할인을 적용한다.
- [x] 일요일과 25일의 경우에는 특별 할인이 적용된다.
    - [x] 일요일과 25일인지 판단한다.
    - [x] 총주문 금액에서 1,000원 할인을 적용한다.

#### 할인 금액과 증정 메뉴의 가격을 바탕으로 총혜택 금액과 할인 후 예상 결제 금액을 계산한다.

``` 
Order 클래스에서 총혜택 금액을 계산한다.
Map에 저장된 각 혜택 내역에서 value만 추출해 총혜택 금액을 계산할 수 있다.
총혜택 금액 계산 후 할인 후 예상 결제 금액을 구하면 된다.
```

- [ ] 총혜택 금액은 할인 금액의 합계와 증정 메뉴의 가격을 합한 값이다.
    - [ ] 할인이 적용되지 않았으면 총 혜택 금액은 0원이다.
- [ ] 할인 후 예상 결제 금액은 할인 전 총주문 금액에서 할인 금액을 차감한 값이다.
    - [ ] 할인이 적용되지 않았으면 예상 결제 금액은 할인 전 총주문 금액과 같다.

#### 총혜택 금액을 바탕으로 이벤트 배지를 부여한다.

``` 
EventBadge enum을 활용해 총혜택 금액에 맞게 이벤트 배지의 이름을 반환하도록 하는 메서드를 구현한다.

산타, 트리, 별, 없음의 순서대로 큰 금액부터 비교를 하게 만든다.
e.g.) 15,000원의 경우 20,000원보다 적기 때문에 산타를 지나치게 되고 10,000원 이상이므로 트리를 반환하게 된다.
```

- [x] 총혜택 금액이 0원인 경우에는 이벤트 배지가 없음으로 출력된다.
- [x] 총혜택 금액이 0원이 아닌 경우에는 금액이 배지를 받을 수 있는 금액인지 판단한다.
    - [x] 5천 원 이상: 별, 1만 원 이상: 트리, 2만 원 이상: 산타

#### 고객에게 출력할 부분

- [x] 메시지 출력 부분
    - [x] 안녕하세요! 우테코 식당 12월 이벤트 플래너입니다.
    - [x] 12월 중 식당 예상 방문 날짜는 언제인가요? (숫자만 입력해 주세요!)
    - [x] 주문하실 메뉴를 메뉴와 개수를 알려 주세요. (e.g. 해산물파스타-2,레드와인-1,초코케이크-1)
    - [ ] 12월 OO일에 우테코 식당에서 받을 이벤트 혜택 미리 보기!
- [ ] 입력한 메뉴가 유효하면 주문한 메뉴를 출력한다.
    - 출력 형식
      ```
      <주문 메뉴>
      티본스테이크 1개
      바비큐립 1개
      초코케이크 2개
      제로콜라 1개
      ```
- [ ] 입력한 날짜와 주문을 통해 계산한 혜택의 결과를 출력한다.
    ```
    각 혜택 내역을 출력하는 담당은 EachOfEventResultMessage에서 담당하도록 한다.
    Map에 저장된 인덱스의 번호에 맞는 메시지를 가져올 수 있도록 한다.
    ```
    - 출력 형식
      ```
      <할인 전 총주문 금액>
      142,000원
 
      <증정 메뉴>
      샴페인 1개
 
      <혜택 내역>
      크리스마스 디데이 할인: -1,200원
      평일 할인: -4,046원
      특별 할인: -1,000원
      증정 이벤트: -25,000원
 
      <총혜택 금액>
      -31,246원
 
      <할인 후 예상 결제 금액>
      135,754원
 
      <12월 이벤트 배지>
      산타
      ```